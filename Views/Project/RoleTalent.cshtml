@model WebApplication1.Models.ProjectRoleModel
@using PagedList.Mvc;  
@{
    ViewBag.Title = "Project";
}

<div>
    <h4>Project Talent</h4>
    <hr />

    <div class="row">
        <div class="group col-md-3">
            <dl class="dl-horizontal">
                <dt>
                    @Html.DisplayNameFor(model => model.Name)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Name)
                </dd>
            </dl>
        </div>
        <div class="group col-md-3">
            <dl class="dl-horizontal">
                <dt>
                    Age Range
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.AgeMin) to @Html.DisplayFor(model => model.AgeMax)
                </dd>
            </dl>
        </div>
        <div class="group col-md-3">
            <dl class="dl-horizontal">
                <dt>
                    Height Range
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.HeightMin) to @Html.DisplayFor(model => model.HeightMax)
                </dd>
            </dl>
        </div>
    </div>

    @using (Html.BeginForm("RoleTalent", "Project", FormMethod.Get))
    {
        <p>
            @Html.TextBox("search", ViewBag.FilterValue as string, new { placeholder = "Search" }) @Html.CheckBox("searchMode", (bool)ViewBag.searchMode) Search All
            <input type="submit" value="Find" />
        </p>
    }  
    <div class="row">
        @foreach (var item in Model.TalentPagedList)
        {
            @Html.DisplayFor(modelItem => item)
        }
    </div>
</div>
@Html.PagedListPager(Model.TalentPagedList, pageNo => Url.Action("RoleTalent", new { pageNo, viewMode = ViewBag.ViewMode, filterValue = ViewBag.FilterValue, searchMode = ViewBag.SearchMode }))
<p>
    @Html.ActionLink("Back to Project", "Edit", new { id = Model.ProjectID })
</p>

<script>
    $(function () {
        $(".tileCheck").click(function () {
            var action = "";
            var tileCheck = $(this);
            var talentID = $(this).children().val();
            var unchecked = $(this).hasClass("glyphicon-unchecked");
            if (unchecked) {
                action = "/Project/AddTalent";
            }
            else {
                action = "/Project/RemoveTalent";
            }

            $.ajax({
                url: action,
                data: { projectRoleID: @Model.ID, talentID: talentID },
                method:"POST",
                success: function () {
                    if (unchecked) {
                        tileCheck.removeClass("glyphicon-unchecked");
                        tileCheck.addClass("glyphicon-check");
                    }
                    else {
                        tileCheck.addClass("glyphicon-unchecked");
                        tileCheck.removeClass("glyphicon-check");
                    }
                }
            });
            return false;
        });
    });
</script>